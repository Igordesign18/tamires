<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LaBella Woman - Sistema PDV</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
        }

        .header {
            background: linear-gradient(135deg, #000000 0%, #1E90FF 100%);
            color: white;
            padding: 1.5rem;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 1.8rem;
            font-weight: bold;
        }

        .header-info {
            display: flex;
            gap: 2rem;
            align-items: center;
        }

        .caixa-status {
            background: rgba(255,255,255,0.2);
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.9rem;
        }

        .btn-sair {
            background: rgba(255,255,255,0.2);
            border: 1px solid white;
            color: white;
            padding: 0.5rem 1.5rem;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-sair:hover {
            background: white;
            color: #1E90FF;
        }

        .nav-tabs {
            background: white;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            padding: 0;
            margin: 0;
        }

        .nav-tabs-content {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            gap: 0;
        }

        .tab-btn {
            flex: 1;
            padding: 1rem;
            border: none;
            background: white;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s;
            border-bottom: 3px solid transparent;
        }

        .tab-btn:hover {
            background: #f8f9fa;
        }

        .tab-btn.active {
            background: linear-gradient(135deg, #000000 0%, #1E90FF 100%);
            color: white;
            border-bottom-color: #1E90FF;
        }

        .container {
            max-width: 1400px;
            margin: 2rem auto;
            padding: 0 1rem;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .card {
            background: white;
            border-radius: 10px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .card-title {
            font-size: 1.3rem;
            margin-bottom: 1rem;
            color: #000000;
            border-bottom: 2px solid #1E90FF;
            padding-bottom: 0.5rem;
        }

        .form-group {
            margin-bottom: 1rem;
        }

        label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: #333;
        }

        input, select, textarea {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 1rem;
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: #1E90FF;
        }

        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s;
            font-weight: 500;
        }

        .btn-primary {
            background: linear-gradient(135deg, #000000 0%, #1E90FF 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(30, 144, 255, 0.3);
        }

        .btn-success {
            background: #28a745;
            color: white;
        }

        .btn-danger {
            background: #dc3545;
            color: white;
        }

        .btn-warning {
            background: #ffc107;
            color: #000;
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1rem;
        }

        th, td {
            padding: 0.75rem;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }

        th {
            background: linear-gradient(135deg, #000000 0%, #1E90FF 100%);
            color: white;
            font-weight: 500;
        }

        tr:hover {
            background: #f8f9fa;
        }

        .grid-2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
        }

        .grid-3 {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1rem;
        }

        .stats-card {
            background: linear-gradient(135deg, #000000 0%, #1E90FF 100%);
            color: white;
            padding: 1.5rem;
            border-radius: 10px;
            text-align: center;
        }

        .stats-value {
            font-size: 2rem;
            font-weight: bold;
            margin: 0.5rem 0;
        }

        .stats-label {
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
        }

        .modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background: white;
            padding: 2rem;
            border-radius: 10px;
            max-width: 600px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .modal-title {
            font-size: 1.5rem;
            color: #000000;
        }

        .close-modal {
            font-size: 2rem;
            cursor: pointer;
            color: #999;
        }

        .close-modal:hover {
            color: #000;
        }

        .cart-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.75rem;
            border: 1px solid #ddd;
            border-radius: 5px;
            margin-bottom: 0.5rem;
        }

        .cart-total {
            font-size: 1.5rem;
            font-weight: bold;
            text-align: right;
            margin-top: 1rem;
            color: #1E90FF;
        }

        .search-results {
            position: absolute;
            background: white;
            border: 1px solid #ddd;
            border-radius: 5px;
            max-height: 200px;
            overflow-y: auto;
            width: calc(100% - 2rem);
            z-index: 100;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .search-result-item {
            padding: 0.75rem;
            cursor: pointer;
            border-bottom: 1px solid #eee;
        }

        .search-result-item:hover {
            background: #f8f9fa;
        }

        .badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 500;
        }

        .badge-success {
            background: #28a745;
            color: white;
        }

        .badge-danger {
            background: #dc3545;
            color: white;
        }

        .period-tabs {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
        }

        .period-tab {
            padding: 0.5rem 1rem;
            border: 2px solid #1E90FF;
            background: white;
            color: #1E90FF;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .period-tab.active {
            background: linear-gradient(135deg, #000000 0%, #1E90FF 100%);
            color: white;
        }

        .comprovante {
            font-family: monospace;
            line-height: 1.6;
        }

        .comprovante-header {
            text-align: center;
            border-bottom: 2px dashed #000;
            padding-bottom: 1rem;
            margin-bottom: 1rem;
        }

        .comprovante-item {
            display: flex;
            justify-content: space-between;
            margin: 0.5rem 0;
        }

        .comprovante-total {
            border-top: 2px dashed #000;
            padding-top: 1rem;
            margin-top: 1rem;
            font-weight: bold;
            font-size: 1.2rem;
        }

        .size-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-top: 0.5rem;
        }

        .size-tag {
            background: #e9ecef;
            padding: 0.25rem 0.75rem;
            border-radius: 15px;
            font-size: 0.85rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .size-tag-remove {
            cursor: pointer;
            color: #dc3545;
            font-weight: bold;
        }

        .size-input-group {
            display: flex;
            gap: 0.5rem;
            margin-top: 0.5rem;
        }

        .size-input-group input {
            flex: 1;
        }

        .size-input-group button {
            padding: 0.5rem 1rem;
        }

        .size-selector {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
            margin-top: 0.5rem;
        }

        .size-option {
            padding: 0.5rem 1rem;
            border: 2px solid #1E90FF;
            background: white;
            color: #1E90FF;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .size-option.selected {
            background: linear-gradient(135deg, #000000 0%, #1E90FF 100%);
            color: white;
        }

        @media print {
            body * {
                visibility: hidden;
            }
            .modal-content, .modal-content * {
                visibility: visible;
            }
            .modal-content {
                position: absolute;
                left: 0;
                top: 0;
            }
            .btn {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="header-content">
            <div class="logo">LaBella Woman</div>
            <div class="header-info">
                <div class="caixa-status">Caixa <span id="caixaStatusHeader">Fechado</span></div>
                <button class="btn-sair" onclick="alert('Saindo do sistema...')">Sair</button>
            </div>
        </div>
    </div>

    <div class="nav-tabs">
        <div class="nav-tabs-content">
            <button class="tab-btn active" onclick="changeTab('pdv')">PDV</button>
            <button class="tab-btn" onclick="changeTab('produtos')">Produtos</button>
            <button class="tab-btn" onclick="changeTab('clientes')">Clientes</button>
            <button class="tab-btn" onclick="changeTab('caixa')">Caixa</button>
            <button class="tab-btn" onclick="changeTab('movimentacoes')">Movimentações</button>
            <button class="tab-btn" onclick="changeTab('relatorios')">Relatórios</button>
        </div>
    </div>

    <div class="container">
        <!-- TAB PDV -->
        <div id="tab-pdv" class="tab-content active">
            <div class="card">
                <h2 class="card-title">Nova Venda</h2>
                <div class="grid-2">
                    <div>
                        <div class="form-group">
                            <label>Cliente</label>
                            <select id="vendaCliente">
                                <option value="">Selecione um cliente</option>
                            </select>
                            <button class="btn btn-secondary" style="margin-top: 0.5rem;" onclick="openModal('modalClienteRapido')">Cadastrar</button>
                        </div>

                        <div class="form-group" style="position: relative;">
                            <label>Buscar</label>
                            <input type="text" id="buscaProduto" placeholder="Buscar produto por nome ou SKU..." oninput="buscarProduto()">
                            <div id="resultadosBusca" class="search-results" style="display: none;"></div>
                        </div>
                    </div>

                    <div>
                        <h3>Carrinho</h3>
                        <div id="carrinho"></div>
                        <div class="form-group">
                            <label>Desconto (%)</label>
                            <input type="number" id="desconto" value="0" min="0" max="100" oninput="atualizarCarrinho()">
                        </div>
                        <div class="cart-total" id="totalVenda">R$ 0,00</div>
                    </div>
                </div>

                <div class="form-group">
                    <label>Forma de Pagamento</label>
                    <select id="formaPagamento">
                        <option value="Dinheiro">Dinheiro</option>
                        <option value="Cartão Débito">Cartão Débito</option>
                        <option value="Cartão Crédito">Cartão Crédito</option>
                        <option value="PIX">PIX</option>
                    </select>
                </div>

                <div class="grid-2">
                    <div class="form-group">
                        <label>Valor Recebido</label>
                        <input type="number" id="valorRecebido" step="0.01" oninput="calcularTroco()">
                    </div>
                    <div class="form-group">
                        <label>Precisa de Troco?</label>
                        <div style="font-size: 1.2rem; font-weight: bold; color: #1E90FF; margin-top: 0.5rem;">Troco: R$ <span id="troco">0,00</span></div>
                    </div>
                </div>

                <button class="btn btn-success" style="width: 100%; padding: 1rem; font-size: 1.1rem;" onclick="finalizarVenda()">Finalizar Venda</button>
            </div>
        </div>

        <!-- TAB PRODUTOS -->
        <div id="tab-produtos" class="tab-content">
            <div class="card">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                    <h2 class="card-title" style="margin: 0;">Gerenciar Produtos</h2>
                    <button class="btn btn-primary" onclick="openModal('modalProduto')">Novo Produto</button>
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>SKU</th>
                            <th>Nome</th>
                            <th>Categoria</th>
                            <th>Tamanhos</th>
                            <th>Preço Venda</th>
                            <th>Preço Custo</th>
                            <th>Estoque</th>
                            <th>Ações</th>
                        </tr>
                    </thead>
                    <tbody id="listaProdutos"></tbody>
                </table>
            </div>
        </div>

        <!-- TAB CLIENTES -->
        <div id="tab-clientes" class="tab-content">
            <div class="card">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                    <h2 class="card-title" style="margin: 0;">Gerenciar Clientes</h2>
                    <button class="btn btn-primary" onclick="openModal('modalCliente')">Novo Cliente</button>
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>Nome</th>
                            <th>Telefone</th>
                            <th>CPF</th>
                            <th>Email</th>
                            <th>Endereço</th>
                            <th>Ações</th>
                        </tr>
                    </thead>
                    <tbody id="listaClientes"></tbody>
                </table>
            </div>
        </div>

        <!-- TAB CAIXA -->
        <div id="tab-caixa" class="tab-content">
            <div class="grid-2">
                <div class="card">
                    <h2 class="card-title">Status do Caixa</h2>
                    <div class="stats-card" style="margin-bottom: 1rem;">
                        <div class="stats-label">Status</div>
                        <div class="stats-value" id="caixaStatusDisplay">Fechado</div>
                    </div>
                    <div class="grid-3">
                        <div>
                            <div class="stats-label">Saldo Inicial</div>
                            <div class="stats-value" style="font-size: 1.2rem; color: #1E90FF;">R$ <span id="saldoInicial">0,00</span></div>
                        </div>
                        <div>
                            <div class="stats-label">Total Vendas</div>
                            <div class="stats-value" style="font-size: 1.2rem; color: #28a745;">R$ <span id="totalVendas">0,00</span></div>
                        </div>
                        <div>
                            <div class="stats-label">Saldo Atual</div>
                            <div class="stats-value" style="font-size: 1.2rem; color: #1E90FF;">R$ <span id="saldoAtual">0,00</span></div>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <h2 class="card-title">Controle de Caixa</h2>
                    <div class="form-group">
                        <label>Valor Inicial</label>
                        <input type="number" id="valorInicialCaixa" step="0.01" placeholder="0.00">
                    </div>
                    <button class="btn btn-success" style="width: 100%; margin-bottom: 0.5rem;" onclick="abrirCaixa()">Abrir Caixa</button>
                    <button class="btn btn-danger" style="width: 100%;" onclick="fecharCaixa()">Fechar Caixa</button>
                </div>
            </div>

            <div class="card">
                <h2 class="card-title">Histórico de Caixas</h2>
                <table>
                    <thead>
                        <tr>
                            <th>Data Abertura</th>
                            <th>Data Fechamento</th>
                            <th>Valor Inicial</th>
                            <th>Valor Final</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody id="historicoCaixas"></tbody>
                </table>
            </div>
        </div>

        <!-- TAB MOVIMENTAÇÕES -->
        <div id="tab-movimentacoes" class="tab-content">
            <div class="card">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                    <h2 class="card-title" style="margin: 0;">Movimentações Financeiras</h2>
                    <button class="btn btn-primary" onclick="openModal('modalMovimentacao')">Nova Movimentação</button>
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>Data/Hora</th>
                            <th>Tipo</th>
                            <th>Descrição</th>
                            <th>Valor</th>
                        </tr>
                    </thead>
                    <tbody id="listaMovimentacoes"></tbody>
                </table>
            </div>
        </div>

        <!-- TAB RELATÓRIOS -->
        <div id="tab-relatorios" class="tab-content">
            <div class="card">
                <h2 class="card-title">Relatórios de Vendas</h2>
                <div class="period-tabs">
                    <button class="period-tab active" onclick="filtrarRelatorio('hoje')">Hoje</button>
                    <button class="period-tab" onclick="filtrarRelatorio('semana')">Esta Semana</button>
                    <button class="period-tab" onclick="filtrarRelatorio('mes')">Este Mês</button>
                </div>

                <div class="grid-2">
                    <div class="stats-card">
                        <div class="stats-label">Vendas no Período</div>
                        <div class="stats-value" id="relatorioQtdVendas">0</div>
                    </div>
                    <div class="stats-card">
                        <div class="stats-label">Total no Período</div>
                        <div class="stats-value">R$ <span id="relatorioTotalVendas">0,00</span></div>
                    </div>
                </div>

                <div class="grid-2" style="margin-top: 1rem;">
                    <div class="stats-card">
                        <div class="stats-label">Produtos Vendidos</div>
                        <div class="stats-value" id="relatorioProdutosVendidos">0</div>
                    </div>
                    <div class="stats-card">
                        <div class="stats-label">Ticket Médio</div>
                        <div class="stats-value">R$ <span id="relatorioTicketMedio">0,00</span></div>
                    </div>
                </div>
            </div>

            <div class="card">
                <h2 class="card-title">Vendas Recentes</h2>
                <table>
                    <thead>
                        <tr>
                            <th>Data/Hora</th>
                            <th>Cliente</th>
                            <th>Total</th>
                            <th>Pagamento</th>
                            <th>Ações</th>
                        </tr>
                    </thead>
                    <tbody id="listaVendas"></tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- MODAL PRODUTO -->
    <div id="modalProduto" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Novo Produto</h2>
                <span class="close-modal" onclick="closeModal('modalProduto')">&times;</span>
            </div>
            <form onsubmit="salvarProduto(event)">
                <div class="form-group">
                    <label>Nome *</label>
                    <input type="text" id="produtoNome" required>
                </div>
                <div class="form-group">
                    <label>SKU *</label>
                    <input type="text" id="produtoSku" required>
                </div>
                <div class="form-group">
                    <label>Categoria</label>
                    <input type="text" id="produtoCategoria">
                </div>
                <div class="form-group">
                    <label>Tamanhos Disponíveis</label>
                    <div class="size-tags" id="tamanhosList"></div>
                    <div class="size-input-group">
                        <input type="text" id="novoTamanho" placeholder="Ex: P, M, G, GG, 36, 38...">
                        <button type="button" class="btn btn-secondary" onclick="adicionarTamanho()">Adicionar</button>
                    </div>
                </div>
                <div class="form-group">
                    <label>Preço de Venda *</label>
                    <input type="number" id="produtoPreco" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>Preço de Custo *</label>
                    <input type="number" id="produtoPrecoCusto" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>Quantidade em Estoque *</label>
                    <input type="number" id="produtoEstoque" required>
                </div>
                <div style="display: flex; gap: 1rem;">
                    <button type="submit" class="btn btn-primary" style="flex: 1;">Salvar</button>
                    <button type="button" class="btn btn-secondary" style="flex: 1;" onclick="closeModal('modalProduto')">Cancelar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- MODAL CLIENTE -->
    <div id="modalCliente" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Novo Cliente</h2>
                <span class="close-modal" onclick="closeModal('modalCliente')">&times;</span>
            </div>
            <form onsubmit="salvarCliente(event)">
                <div class="form-group">
                    <label>Nome *</label>
                    <input type="text" id="clienteNome" required>
                </div>
                <div class="form-group">
                    <label>Telefone *</label>
                    <input type="tel" id="clienteTelefone" required>
                </div>
                <div class="form-group">
                    <label>CPF</label>
                    <input type="text" id="clienteCpf">
                </div>
                <div class="form-group">
                    <label>Email</label>
                    <input type="email" id="clienteEmail">
                </div>
                <div class="form-group">
                    <label>Endereço Completo</label>
                    <textarea id="clienteEndereco" rows="3"></textarea>
                </div>
                <div style="display: flex; gap: 1rem;">
                    <button type="submit" class="btn btn-primary" style="flex: 1;">Salvar</button>
                    <button type="button" class="btn btn-secondary" style="flex: 1;" onclick="closeModal('modalCliente')">Cancelar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- MODAL CLIENTE RÁPIDO -->
    <div id="modalClienteRapido" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Cadastro Rápido - Cliente</h2>
                <span class="close-modal" onclick="closeModal('modalClienteRapido')">&times;</span>
            </div>
            <form onsubmit="salvarClienteRapido(event)">
                <div class="form-group">
                    <label>Nome *</label>
                    <input type="text" id="clienteRapidoNome" required>
                </div>
                <div class="form-group">
                    <label>Telefone *</label>
                    <input type="tel" id="clienteRapidoTelefone" required>
                </div>
                <div style="display: flex; gap: 1rem;">
                    <button type="submit" class="btn btn-primary" style="flex: 1;">Cadastrar e Selecionar</button>
                    <button type="button" class="btn btn-secondary" style="flex: 1;" onclick="closeModal('modalClienteRapido')">Cancelar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- MODAL MOVIMENTAÇÃO -->
    <div id="modalMovimentacao" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Nova Movimentação</h2>
                <span class="close-modal" onclick="closeModal('modalMovimentacao')">&times;</span>
            </div>
            <form onsubmit="salvarMovimentacao(event)">
                <div class="form-group">
                    <label>Tipo *</label>
                    <select id="movimentacaoTipo" required>
                        <option value="Entrada">Entrada</option>
                        <option value="Saída">Saída</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Valor *</label>
                    <input type="number" id="movimentacaoValor" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>Descrição *</label>
                    <textarea id="movimentacaoDescricao" rows="3" required></textarea>
                </div>
                <div style="display: flex; gap: 1rem;">
                    <button type="submit" class="btn btn-primary" style="flex: 1;">Salvar</button>
                    <button type="button" class="btn btn-secondary" style="flex: 1;" onclick="closeModal('modalMovimentacao')">Cancelar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- MODAL COMPROVANTE -->
    <div id="modalComprovante" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Comprovante de Venda</h2>
                <span class="close-modal" onclick="closeModal('modalComprovante')">&times;</span>
            </div>
            <div id="comprovanteConteudo" class="comprovante"></div>
            <div style="display: flex; gap: 1rem; margin-top: 1.5rem;">
                <button class="btn btn-primary" style="flex: 1;" onclick="window.print()">Imprimir</button>
                <button class="btn btn-secondary" style="flex: 1;" onclick="alert('Funcionalidade de compartilhamento em desenvolvimento')">Compartilhar</button>
            </div>
        </div>
    </div>

    <!-- MODAL SELEÇÃO DE TAMANHO -->
    <div id="modalTamanho" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Selecione o Tamanho</h2>
                <span class="close-modal" onclick="closeModal('modalTamanho')">&times;</span>
            </div>
            <div>
                <p><strong>Produto:</strong> <span id="tamanhoNomeProduto"></span></p>
                <div class="form-group">
                    <label>Tamanhos Disponíveis:</label>
                    <div id="tamanhoOptions" class="size-selector"></div>
                </div>
                <div class="form-group">
                    <label>Quantidade:</label>
                    <input type="number" id="tamanhoQuantidade" value="1" min="1">
                </div>
                <div style="display: flex; gap: 1rem; margin-top: 1rem;">
                    <button class="btn btn-primary" style="flex: 1;" onclick="confirmarTamanho()">Adicionar ao Carrinho</button>
                    <button class="btn btn-secondary" style="flex: 1;" onclick="closeModal('modalTamanho')">Cancelar</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Dados em memória
        let produtos = [];
        let clientes = [];
        let vendas = [];
        let carrinho = [];
        let caixaAberto = false;
        let caixaAtual = null;
        let historicoCaixas = [];
        let movimentacoes = [];
        let periodoRelatorio = 'hoje';
        let tamanhosProdutoAtual = [];
        let produtoParaAdicionar = null;
        let tamanhoSelecionado = null;

        // Funções de navegação
        function changeTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            document.getElementById('tab-' + tabName).classList.add('active');
            event.target.classList.add('active');

            if (tabName === 'relatorios') {
                atualizarRelatorios();
            }
        }

        // Funções de modal
        function openModal(modalId) {
            document.getElementById(modalId).classList.add('active');
            if (modalId === 'modalProduto') {
                limparFormProduto();
            }
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
        }

        // Funções de tamanhos
        function adicionarTamanho() {
            const input = document.getElementById('novoTamanho');
            const tamanho = input.value.trim().toUpperCase();
            
            if (tamanho && !tamanhosProdutoAtual.includes(tamanho)) {
                tamanhosProdutoAtual.push(tamanho);
                atualizarListaTamanhos();
                input.value = '';
            }
        }

        function removerTamanho(tamanho) {
            tamanhosProdutoAtual = tamanhosProdutoAtual.filter(t => t !== tamanho);
            atualizarListaTamanhos();
        }

        function atualizarListaTamanhos() {
            const lista = document.getElementById('tamanhosList');
            lista.innerHTML = tamanhosProdutoAtual.map(t => 
                `<span class="size-tag">${t} <span class="size-tag-remove" onclick="removerTamanho('${t}')">×</span></span>`
            ).join('');
        }

        function limparFormProduto() {
            document.getElementById('produtoNome').value = '';
            document.getElementById('produtoSku').value = '';
            document.getElementById('produtoCategoria').value = '';
            document.getElementById('produtoPreco').value = '';
            document.getElementById('produtoPrecoCusto').value = '';
            document.getElementById('produtoEstoque').value = '';
            document.getElementById('novoTamanho').value = '';
            tamanhosProdutoAtual = [];
            atualizarListaTamanhos();
        }

        // Produtos
        function salvarProduto(e) {
            e.preventDefault();
            const produto = {
                id: Date.now().toString(),
                nome: document.getElementById('produtoNome').value,
                sku: document.getElementById('produtoSku').value,
                categoria: document.getElementById('produtoCategoria').value,
                preco: parseFloat(document.getElementById('produtoPreco').value),
                precoCusto: parseFloat(document.getElementById('produtoPrecoCusto').value),
                estoque: parseInt(document.getElementById('produtoEstoque').value),
                tamanhos: [...tamanhosProdutoAtual]
            };
            produtos.push(produto);
            atualizarListaProdutos();
            closeModal('modalProduto');
            alert('Produto cadastrado com sucesso!');
        }

        function atualizarListaProdutos() {
            const lista = document.getElementById('listaProdutos');
            lista.innerHTML = produtos.map(p => `
                <tr>
                    <td>${p.sku}</td>
                    <td>${p.nome}</td>
                    <td>${p.categoria}</td>
                    <td>${p.tamanhos.length > 0 ? p.tamanhos.join(', ') : '-'}</td>
                    <td>R$ ${p.preco.toFixed(2)}</td>
                    <td>R$ ${p.precoCusto.toFixed(2)}</td>
                    <td>${p.estoque}</td>
                    <td>
                        <button class="btn btn-danger" onclick="excluirProduto('${p.id}')">Excluir</button>
                    </td>
                </tr>
            `).join('');
        }

        function excluirProduto(id) {
            if (confirm('Deseja realmente excluir este produto?')) {
                produtos = produtos.filter(p => p.id !== id);
                atualizarListaProdutos();
            }
        }

        // Clientes
        function salvarCliente(e) {
            e.preventDefault();
            const cliente = {
                id: Date.now().toString(),
                nome: document.getElementById('clienteNome').value,
                telefone: document.getElementById('clienteTelefone').value,
                cpf: document.getElementById('clienteCpf').value,
                email: document.getElementById('clienteEmail').value,
                endereco: document.getElementById('clienteEndereco').value
            };
            clientes.push(cliente);
            atualizarListaClientes();
            atualizarSelectClientes();
            closeModal('modalCliente');
            alert('Cliente cadastrado com sucesso!');
        }

        function salvarClienteRapido(e) {
            e.preventDefault();
            const cliente = {
                id: Date.now().toString(),
                nome: document.getElementById('clienteRapidoNome').value,
                telefone: document.getElementById('clienteRapidoTelefone').value,
                cpf: '',
                email: '',
                endereco: ''
            };
            clientes.push(cliente);
            atualizarListaClientes();
            atualizarSelectClientes();
            document.getElementById('vendaCliente').value = cliente.id;
            closeModal('modalClienteRapido');
            alert('Cliente cadastrado e selecionado!');
        }

        function atualizarListaClientes() {
            const lista = document.getElementById('listaClientes');
            lista.innerHTML = clientes.map(c => `
                <tr>
                    <td>${c.nome}</td>
                    <td>${c.telefone}</td>
                    <td>${c.cpf || '-'}</td>
                    <td>${c.email || '-'}</td>
                    <td>${c.endereco || '-'}</td>
                    <td>
                        <button class="btn btn-danger" onclick="excluirCliente('${c.id}')">Excluir</button>
                    </td>
                </tr>
            `).join('');
        }

        function excluirCliente(id) {
            if (confirm('Deseja realmente excluir este cliente?')) {
                clientes = clientes.filter(c => c.id !== id);
                atualizarListaClientes();
                atualizarSelectClientes();
            }
        }

        function atualizarSelectClientes() {
            const select = document.getElementById('vendaCliente');
            select.innerHTML = '<option value="">Selecione um cliente</option>' + 
                clientes.map(c => `<option value="${c.id}">${c.nome}</option>`).join('');
        }

        // PDV - Busca de produtos
        function buscarProduto() {
            const busca = document.getElementById('buscaProduto').value.toLowerCase();
            const resultados = document.getElementById('resultadosBusca');
            
            if (busca.length < 2) {
                resultados.style.display = 'none';
                return;
            }

            const produtosFiltrados = produtos.filter(p => 
                p.nome.toLowerCase().includes(busca) || 
                p.sku.toLowerCase().includes(busca)
            );

            if (produtosFiltrados.length > 0) {
                resultados.innerHTML = produtosFiltrados.map(p => `
                    <div class="search-result-item" onclick="selecionarProduto('${p.id}')">
                        <strong>${p.nome}</strong> - SKU: ${p.sku} - R$ ${p.preco.toFixed(2)}
                        ${p.tamanhos.length > 0 ? '<br><small>Tamanhos: ' + p.tamanhos.join(', ') + '</small>' : ''}
                    </div>
                `).join('');
                resultados.style.display = 'block';
            } else {
                resultados.innerHTML = '<div class="search-result-item">Nenhum produto encontrado</div>';
                resultados.style.display = 'block';
            }
        }

        function selecionarProduto(id) {
            const produto = produtos.find(p => p.id === id);
            if (produto) {
                if (produto.tamanhos.length > 0) {
                    produtoParaAdicionar = produto;
                    abrirModalTamanho(produto);
                } else {
                    adicionarAoCarrinho(produto, 1);
                }
                document.getElementById('buscaProduto').value = '';
                document.getElementById('resultadosBusca').style.display = 'none';
            }
        }

        function abrirModalTamanho(produto) {
            document.getElementById('tamanhoNomeProduto').textContent = produto.nome;
            const optionsDiv = document.getElementById('tamanhoOptions');
            optionsDiv.innerHTML = produto.tamanhos.map(t => 
                `<button type="button" class="size-option" onclick="selecionarTamanhoOpcao('${t}')">${t}</button>`
            ).join('');
            document.getElementById('tamanhoQuantidade').value = 1;
            tamanhoSelecionado = null;
            openModal('modalTamanho');
        }

        function selecionarTamanhoOpcao(tamanho) {
            document.querySelectorAll('.size-option').forEach(btn => btn.classList.remove('selected'));
            event.target.classList.add('selected');
            tamanhoSelecionado = tamanho;
        }

        function confirmarTamanho() {
            if (!tamanhoSelecionado) {
                alert('Por favor, selecione um tamanho!');
                return;
            }
            const quantidade = parseInt(document.getElementById('tamanhoQuantidade').value);
            adicionarAoCarrinho(produtoParaAdicionar, quantidade, tamanhoSelecionado);
            closeModal('modalTamanho');
            produtoParaAdicionar = null;
            tamanhoSelecionado = null;
        }

        function adicionarAoCarrinho(produto, quantidade = 1, tamanho = null) {
            if (produto.estoque < quantidade) {
                alert('Estoque insuficiente!');
                return;
            }

            const itemExistente = carrinho.find(item => 
                item.produto.id === produto.id && item.tamanhoSelecionado === tamanho
            );

            if (itemExistente) {
                itemExistente.quantidade += quantidade;
            } else {
                carrinho.push({
                    produto: produto,
                    quantidade: quantidade,
                    tamanhoSelecionado: tamanho
                });
            }
            atualizarCarrinho();
        }

        function removerDoCarrinho(index) {
            carrinho.splice(index, 1);
            atualizarCarrinho();
        }

        function atualizarCarrinho() {
            const carrinhoDiv = document.getElementById('carrinho');
            const desconto = parseFloat(document.getElementById('desconto').value) || 0;
            
            if (carrinho.length === 0) {
                carrinhoDiv.innerHTML = '<p style="color: #999;">Carrinho vazio</p>';
                document.getElementById('totalVenda').textContent = 'R$ 0,00';
                return;
            }

            let subtotal = 0;
            carrinhoDiv.innerHTML = carrinho.map((item, index) => {
                const itemTotal = item.produto.preco * item.quantidade;
                subtotal += itemTotal;
                return `
                    <div class="cart-item">
                        <div>
                            <strong>${item.produto.nome}</strong>
                            ${item.tamanhoSelecionado ? '<br><small>Tamanho: ' + item.tamanhoSelecionado + '</small>' : ''}
                            <br>R$ ${item.produto.preco.toFixed(2)} x ${item.quantidade}
                        </div>
                        <div style="text-align: right;">
                            <div>R$ ${itemTotal.toFixed(2)}</div>
                            <button class="btn btn-danger" style="margin-top: 0.5rem; padding: 0.25rem 0.5rem;" onclick="removerDoCarrinho(${index})">Remover</button>
                        </div>
                    </div>
                `;
            }).join('');

            const valorDesconto = subtotal * (desconto / 100);
            const total = subtotal - valorDesconto;
            document.getElementById('totalVenda').textContent = 'R$ ' + total.toFixed(2);
        }

        function calcularTroco() {
            const total = parseFloat(document.getElementById('totalVenda').textContent.replace('R$ ', '').replace(',', '.'));
            const recebido = parseFloat(document.getElementById('valorRecebido').value) || 0;
            const troco = Math.max(0, recebido - total);
            document.getElementById('troco').textContent = troco.toFixed(2);
        }

        function finalizarVenda() {
            if (!caixaAberto) {
                alert('Caixa está fechado! Abra o caixa primeiro.');
                return;
            }

            if (carrinho.length === 0) {
                alert('Carrinho vazio!');
                return;
            }

            const clienteId = document.getElementById('vendaCliente').value;
            if (!clienteId) {
                alert('Selecione um cliente!');
                return;
            }

            const desconto = parseFloat(document.getElementById('desconto').value) || 0;
            const subtotal = carrinho.reduce((sum, item) => sum + (item.produto.preco * item.quantidade), 0);
            const total = subtotal - (subtotal * desconto / 100);
            const formaPagamento = document.getElementById('formaPagamento').value;

            // Atualizar estoque
            carrinho.forEach(item => {
                const produto = produtos.find(p => p.id === item.produto.id);
                if (produto) {
                    produto.estoque -= item.quantidade;
                }
            });

            // Registrar venda
            const venda = {
                id: Date.now().toString(),
                dataHora: new Date().toLocaleString('pt-BR'),
                cliente: clientes.find(c => c.id === clienteId)?.nome || 'Cliente não identificado',
                total: total,
                pagamento: formaPagamento,
                itens: [...carrinho]
            };
            vendas.push(venda);

            // Atualizar caixa
            caixaAtual.totalVendas += total;

            // Limpar carrinho
            carrinho = [];
            document.getElementById('desconto').value = '0';
            document.getElementById('valorRecebido').value = '';
            document.getElementById('vendaCliente').value = '';
            atualizarCarrinho();
            atualizarListaProdutos();
            atualizarStatusCaixa();

            // Mostrar comprovante
            gerarComprovante(venda);
            alert('Venda finalizada com sucesso!');
        }

        function gerarComprovante(venda) {
            const comprovante = `
                <div class="comprovante-header">
                    <h2>LaBella Woman</h2>
                    <p>Comprovante de Venda</p>
                    <p>${venda.dataHora}</p>
                </div>
                <p><strong>Cliente:</strong> ${venda.cliente}</p>
                <p><strong>Pagamento:</strong> ${venda.pagamento}</p>
                <hr>
                ${venda.itens.map(item => `
                    <div class="comprovante-item">
                        <span>${item.produto.nome} ${item.tamanhoSelecionado ? '(' + item.tamanhoSelecionado + ')' : ''} x${item.quantidade}</span>
                        <span>R$ ${(item.produto.preco * item.quantidade).toFixed(2)}</span>
                    </div>
                `).join('')}
                <div class="comprovante-total">
                    <div class="comprovante-item">
                        <span>TOTAL</span>
                        <span>R$ ${venda.total.toFixed(2)}</span>
                    </div>
                </div>
                <hr>
                <p style="text-align: center; margin-top: 1rem;">Obrigado pela preferência!</p>
            `;
            document.getElementById('comprovanteConteudo').innerHTML = comprovante;
            openModal('modalComprovante');
        }

        // Caixa
        function abrirCaixa() {
            const valorInicial = parseFloat(document.getElementById('valorInicialCaixa').value);
            if (isNaN(valorInicial) || valorInicial < 0) {
                alert('Digite um valor inicial válido!');
                return;
            }

            caixaAtual = {
                id: Date.now().toString(),
                dataAbertura: new Date().toLocaleString('pt-BR'),
                dataFechamento: null,
                valorInicial: valorInicial,
                totalVendas: 0,
                status: 'Aberto'
            };

            caixaAberto = true;
            atualizarStatusCaixa();
            alert('Caixa aberto com sucesso!');
        }

        function fecharCaixa() {
            if (!caixaAberto) {
                alert('Caixa já está fechado!');
                return;
            }

            if (confirm('Deseja realmente fechar o caixa?')) {
                caixaAtual.dataFechamento = new Date().toLocaleString('pt-BR');
                caixaAtual.status = 'Fechado';
                historicoCaixas.push({...caixaAtual});
                
                caixaAberto = false;
                caixaAtual = null;
                atualizarStatusCaixa();
                atualizarHistoricoCaixas();
                alert('Caixa fechado com sucesso!');
            }
        }

        function atualizarStatusCaixa() {
            const status = caixaAberto ? 'Aberto' : 'Fechado';
            document.getElementById('caixaStatusHeader').textContent = status;
            document.getElementById('caixaStatusDisplay').textContent = status;

            if (caixaAberto && caixaAtual) {
                document.getElementById('saldoInicial').textContent = caixaAtual.valorInicial.toFixed(2);
                document.getElementById('totalVendas').textContent = caixaAtual.totalVendas.toFixed(2);
                document.getElementById('saldoAtual').textContent = (caixaAtual.valorInicial + caixaAtual.totalVendas).toFixed(2);
            } else {
                document.getElementById('saldoInicial').textContent = '0,00';
                document.getElementById('totalVendas').textContent = '0,00';
                document.getElementById('saldoAtual').textContent = '0,00';
            }
        }

        function atualizarHistoricoCaixas() {
            const lista = document.getElementById('historicoCaixas');
            lista.innerHTML = historicoCaixas.map(c => `
                <tr>
                    <td>${c.dataAbertura}</td>
                    <td>${c.dataFechamento || '-'}</td>
                    <td>R$ ${c.valorInicial.toFixed(2)}</td>
                    <td>R$ ${(c.valorInicial + c.totalVendas).toFixed(2)}</td>
                    <td><span class="badge ${c.status === 'Aberto' ? 'badge-success' : 'badge-danger'}">${c.status}</span></td>
                </tr>
            `).join('');
        }

        // Movimentações
        function salvarMovimentacao(e) {
            e.preventDefault();
            const movimentacao = {
                id: Date.now().toString(),
                dataHora: new Date().toLocaleString('pt-BR'),
                tipo: document.getElementById('movimentacaoTipo').value,
                valor: parseFloat(document.getElementById('movimentacaoValor').value),
                descricao: document.getElementById('movimentacaoDescricao').value
            };
            movimentacoes.push(movimentacao);
            atualizarListaMovimentacoes();
            closeModal('modalMovimentacao');
            alert('Movimentação registrada com sucesso!');
        }

        function atualizarListaMovimentacoes() {
            const lista = document.getElementById('listaMovimentacoes');
            lista.innerHTML = movimentacoes.map(m => `
                <tr>
                    <td>${m.dataHora}</td>
                    <td><span class="badge ${m.tipo === 'Entrada' ? 'badge-success' : 'badge-danger'}">${m.tipo}</span></td>
                    <td>${m.descricao}</td>
                    <td style="color: ${m.tipo === 'Entrada' ? '#28a745' : '#dc3545'}">R$ ${m.valor.toFixed(2)}</td>
                </tr>
            `).join('');
        }

        // Relatórios
        function filtrarRelatorio(periodo) {
            periodoRelatorio = periodo;
            document.querySelectorAll('.period-tab').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            atualizarRelatorios();
        }

        function atualizarRelatorios() {
            const agora = new Date();
            let vendasFiltradas = vendas;

            if (periodoRelatorio === 'hoje') {
                vendasFiltradas = vendas.filter(v => {
                    const dataVenda = new Date(v.dataHora.split(', ')[0].split('/').reverse().join('-'));
                    return dataVenda.toDateString() === agora.toDateString();
                });
            } else if (periodoRelatorio === 'semana') {
                const inicioSemana = new Date(agora);
                inicioSemana.setDate(agora.getDate() - agora.getDay());
                vendasFiltradas = vendas.filter(v => {
                    const dataVenda = new Date(v.dataHora.split(', ')[0].split('/').reverse().join('-'));
                    return dataVenda >= inicioSemana;
                });
            } else if (periodoRelatorio === 'mes') {
                vendasFiltradas = vendas.filter(v => {
                    const dataVenda = new Date(v.dataHora.split(', ')[0].split('/').reverse().join('-'));
                    return dataVenda.getMonth() === agora.getMonth() && dataVenda.getFullYear() === agora.getFullYear();
                });
            }

            const totalVendas = vendasFiltradas.reduce((sum, v) => sum + v.total, 0);
            const produtosVendidos = vendasFiltradas.reduce((sum, v) => sum + v.itens.reduce((s, i) => s + i.quantidade, 0), 0);
            const ticketMedio = vendasFiltradas.length > 0 ? totalVendas / vendasFiltradas.length : 0;

            document.getElementById('relatorioQtdVendas').textContent = vendasFiltradas.length;
            document.getElementById('relatorioTotalVendas').textContent = totalVendas.toFixed(2);
            document.getElementById('relatorioProdutosVendidos').textContent = produtosVendidos;
            document.getElementById('relatorioTicketMedio').textContent = ticketMedio.toFixed(2);

            atualizarListaVendas();
        }

        function atualizarListaVendas() {
            const lista = document.getElementById('listaVendas');
            lista.innerHTML = vendas.slice(-10).reverse().map(v => `
                <tr>
                    <td>${v.dataHora}</td>
                    <td>${v.cliente}</td>
                    <td>R$ ${v.total.toFixed(2)}</td>
                    <td>${v.pagamento}</td>
                    <td>
                        <button class="btn btn-primary" onclick="gerarComprovante(${JSON.stringify(v).replace(/"/g, '&quot;')})">Ver Comprovante</button>
                    </td>
                </tr>
            `).join('');
        }

        // Inicialização
        window.onload = function() {
            atualizarStatusCaixa();
            atualizarListaProdutos();
            atualizarListaClientes();
            atualizarSelectClientes();
        };
    </script>
</body>
</html>
